<div [ngClass]="{'show': isShown, 'hide': !isShown}" class="backdrop">
  <div *ngIf="gift" class="modal">
    <ng-container *ngIf="!editingGift; else editForm">
      <span *ngIf="gift.isDeleted" class="error">
        <div><app-icon icon="error" [hover]="null" size="1.5em"></app-icon></div>
        <p>{{'This gift has been deleted by ' + this.gift.isWishedByUser.displayName + '. It is no longer on their wish list.'}}</p>
      </span>
      <app-page-heading
        [headingText]="gift.name"
        (onBackButton)="onModalClose.emit(true);"
        >
      </app-page-heading>
      <p>{{gift.details}}</p>
      <a class="link-btn" [href]="gift.url">
        <button class="link-btn">
          <app-icon icon="link" [hover]="null" size="20px"></app-icon>Link to gift
        </button>
      </a>
      <!-- Shopping list status bar -->
      <div *ngIf="type === 'shopping'" class="status-display">
        <h4 class="track-gift">Track your gift:</h4>
        <div class="line">
          <div *ngFor="let status of statuses" class="node" [style]="status.name === gift.status ? 'color: green' : ''">
            <app-icon
              [icon]="status.icon"
              [hover]="false"
              (iconClicked)="onStatusUpdated.emit(status.name)"
              [title]="status.name | titlecase"
              >
            </app-icon>
          </div>
        </div>
      </div>
      <!-- Bottom button (edit/claim/unclaim) -->
      <div class="bottom-button-wrap">
        <span *ngIf="buttonText === 'This gift has already been claimed.'; else modalButton">{{buttonText}}</span>
        <ng-template #modalButton>
          <button class="bottom-button" (click)="buttonClick(buttonType)"><app-icon [icon]="getIcon()" [hover]="null" size="20px"></app-icon>{{buttonText}}</button>
        </ng-template>
      </div>
    </ng-container>
    <ng-template #editForm>
      <app-page-heading headingText="Edit Gift" (onBackButton)="editingGift = false"></app-page-heading>
      <app-gift-form [type]="gift.isCustom ? 'shopping' : 'wish'" [gift]="gift" (onFormSubmit)="buttonClick($event)"></app-gift-form>
      <app-pop-up
        class="btn-red"
        buttonText="Delete Gift"
        buttonIcon="delete_forever"
        title="Are you sure you want to delete this gift?"
        body="This cannot be undone."
        confirmText="Delete"
        (onConfirm)="buttonClick('delete')"
      ></app-pop-up>
    </ng-template>
  </div>
  <app-filler size="footer"></app-filler>
</div>