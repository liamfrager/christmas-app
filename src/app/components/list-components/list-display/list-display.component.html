<div *ngIf="list; else loadingGifts" class="list">
  <ng-container *ngIf="list.type !== 'error'; else errorLoadingGifts">
    <!-- Display list owner -->
     <app-user-display *ngIf="list.type !== 'shopping' && !isOwnedByCurrentUser"
      [user]="list.owner"
      [onClick]="null"
      >
    </app-user-display>
    <!-- Display gifts -->
    <div *ngIf="list.giftsByUser; else noGifts" [ngClass]="{'gift-list': true, 'modal-open': isModalOpen}">
      <div *ngFor="let giftByUser of list.giftsByUser | keyvalue">
        <!-- If is shopping-list -->
        <ng-container *ngIf="list.type === 'shopping'">
          <app-user-display
          [user]="giftByUser.value.user"
          >
          </app-user-display>
          <hr>
        </ng-container>
        <ul>
          <li *ngFor="let gift of giftByUser.value.gifts | keyvalue">
            <app-gift-display
              class="gift"
              [gift]="gift.value"
              [checkType]="getCheckType(gift.value)"
              (giftClicked)="showInModal(gift.value)"
              >
            </app-gift-display>
          </li>
        </ul>
        <hr>
      </div>
      <!-- Gift details slide-over -->
      <app-gift-details-modal
        [gift]="giftInModal"
        [type]="list.type"
        [buttonType]="modalButtonType"
        [isShown]="isModalOpen"
        (onButtonClick)="onModalButtonClick($event)"
        (onStatusUpdated)="updateStatus($event)"
        (onModalClose)="hideModal()"
        >
      </app-gift-details-modal>
    </div>
    <!-- If no gifts -->
    <ng-template #noGifts>
      <p>{{noGiftsMessage}}</p>
    </ng-template>
  </ng-container>
  <!-- If gifts failed to load -->
  <ng-template #errorLoadingGifts>
    <p>Something went wrong. The list could not be loaded.</p>
  </ng-template>
</div>
<!-- Loading gifts -->
<ng-template #loadingGifts>
  <p>Loading gifts...</p>
</ng-template>